# ðŸ“¡ PDS: Git Action for LDD Generation
# =====================================
#
# This is a GitHub action that generates LDD for the current LDD Github Repo

---

name: 'âœ… PDS LDD Generation'
author: 'Jordan Padams <jordan.h.padams@jpl.nasa.gov>'
branding:
  icon: 'archive'
  color: 'green'

inputs:
  datapath:
    description: |
      Absolute path to data to validate
    required: true
  pds4_im_version:
    description: |
      PDS4 Information Model Version. Defaults to the latest version. Use the semantic version, e.g. 1.14.0.0
    required: false
    default: 'latest'
  release:
    description: |
      Flag to specify if this is intended as a release or a development build.
    required: false
    default: 'false'
  github_token:
    description: |
      Github secret token
    required: true

runs:
  using: 'composite'
  # using: 'composite'
  # image: 'Dockerfile'
  steps:
    - run: '${{ github.action_path }}/entrypoint.sh "${{inputs.datapath}}" "${{inputs.pds4_im_version}}" "${{inputs.release}}"'
      shell: bash
    - run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        git config --local github.token ${{ inputs.github_token }}
        git add $DEPLOY_DIR
        git commit -m "Auto-generated dictionaries from Github Actions"
        git config --global push.default current
        git push
      shell: bash
    - run: '${{ github.action_path }}/validate.sh "${{inputs.datapath}}" "${{inputs.pds4_im_version}}" "${{inputs.release}}"'
      shell: bash

